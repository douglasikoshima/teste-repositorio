//
// $Id: get_statuscampanha.pcpp,v 1.1 2009/07/31 15:34:11 a5110702 Exp $
//

#undef SQLCA
#define SQLCA_NONE
#include<sqlca.h>
#include<sqlda.h>

#include "orautil.h"
#include "TuxFW10.h"
#include "XMLImpl.h"

//extern struct sqlca sqlca;
//extern int sql_error(char *msg);

int get_tipostatuscampanha(DOMNode*dnode,XMLGen*xml)
{
  
  EXEC SQL BEGIN DECLARE SECTION;
    int idtipostatusCampanha;
    VARCHAR sgtipostatusCampanha[255];
    VARCHAR dstipostatusCampanha[255];
  EXEC SQL END DECLARE SECTION;
  EXEC SQL WHENEVER SQLERROR DO sql_error(NULL);
  EXEC SQL WHENEVER NOT FOUND DO break;

  EXEC SQL DECLARE crstipostatusCampanha CURSOR FOR
    SELECT idtipostatusCampanha,sgtipostatusCampanha,dstipostatusCampanha
    FROM apoio.tipostatuscampanha;
  
  EXEC SQL OPEN crstipostatusCampanha;

  xml->addItem("nome","TIPOSTATUSCAMPANHA");
  for(;;) {
    EXEC SQL FETCH crstipostatusCampanha INTO :idtipostatusCampanha,:sgtipostatusCampanha,:dstipostatusCampanha;
    endOraStr(sgtipostatusCampanha);
    endOraStr(dstipostatusCampanha);
    xml->createTag("tns:StatusCampanhaVO");
    xml->addItem("codigo",idtipostatusCampanha);
    xml->addItem("sigla",(char *)sgtipostatusCampanha.arr);
    xml->addItem("descricao",(char *)dstipostatusCampanha.arr);
    xml->addItem("peso","null");
    xml->addItem("variante","null");
    xml->closeTag();
  }
  
  EXEC SQL CLOSE crstipostatusCampanha;
  
  return 1;
}
