//
// $Id: upd_tipocampanha.pcpp,v 1.1 2009/07/31 15:34:10 a5110702 Exp $
//

#include "../../negocio/cmputil/include/campanha.hpp"

int upd_tipocampanha(char * usuario, DOMNode*dnode, XMLGen*xml)
{
	char parm[2000];

	EXEC SQL BEGIN DECLARE SECTION;
		int		idTipoCampanha;
		VARCHAR sgTipoCampanha[2000];
		VARCHAR nmTipoCampanha[2000];
		int     idPessoaUsuarioAlteracao;
	EXEC SQL END DECLARE SECTION;
	EXEC SQL WHENEVER SQLERROR DO sql_error(NULL);

    //  Obtendo dados do xml

	get_tag(parm, dnode, "idTipoCampanha", 0, 0);
	idTipoCampanha = atoi(parm);

    //  Obtendo dados do xml

	get_tag(parm, dnode, "sgTipoCampanha", 0, 0);
	strToOra(sgTipoCampanha,parm);

    //  Obtendo dados do xml

	get_tag(parm, dnode, "nmTipoCampanha", 0, 0);
	strToOra(nmTipoCampanha,parm);


	// Pegando id do usuario
	idPessoaUsuarioAlteracao = get_idUsuario(usuario);

	/* Update linha */
	EXEC SQL UPDATE apoio.tipocampanha
	    SET sgtipocampanha = :sgTipoCampanha,
			nmtipocampanha = :nmTipoCampanha
		WHERE idtipocampanha = :idTipoCampanha;
  
	if (sqlca.sqlcode)
	{
		throw new TuxBasicSvcException("00E1000","UPDATE apoio.tipocampanha ");
	}
  
	/* update OK */
	xml->createTag("TIPOCAMPANHA");
		xml->addItem("UPDATE",sqlca.sqlerrd[2]);
	xml->closeTag();
  
	return 1;
}
