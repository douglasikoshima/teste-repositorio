	/* Verifica se existe o item a adcionar */
	EXEC SQL DECLARE crsParamCmp CURSOR FOR
		SELECT PARAMETRIZACAOCAMPANHA.idcanalcampanha
                FROM campanha.Parametrizacaocampanha PARAMETRIZACAOCAMPANHA
		WHERE  PARAMETRIZACAOCAMPANHA.idcanalcampanha = :idCanalCampanha;

	EXEC SQL OPEN crsParamCmp;

	for(;;) 
	{
		EXEC SQL FETCH crsParamCmp INTO :idGotcha;
		break;
	}
  
	EXEC SQL CLOSE crsParamCmp;	
	
	if(idGotcha == 0)
	{
		/* Insert linha */
		EXEC SQL INSERT INTO campanha.Parametrizacaocampanha(idcanalcampanha,
                                                                        nrtempomediocontato, 
                                                                        nrmetadiariacampanha, 
                                                                        nrmetadiariaoperador, 
                                                                        nrcontatoefetivooperador, 
                                                                        nrcontatoefetivocampanha, 
                                                                        nrcontatosucessooperador, 
                                                                        nrcontatosucessocampanha, 
                                                                        nrpublicototal, 
                                                                        nraderiuoperador, 
                                                                        nraderiucampanha, 
                                                                        nrnaoaderiuoperador, 
                                                                        nrnaoaderiucampanha,
                                                                        idusuarioalteracao,
                                               				dtultimaalteracao) 
                                                                 VALUES(:idCanalCampanha,
                                                                        :nrTempoMedioContato,
                                                                        :nrMetaDiariaCampanha,
                                                                        :nrMetaDiariaOperador,
                                                                        :nrContatoEfetivoOperador,
                                                                        :nrContatoEfetivoCampanha,
                                                                        :nrContatoSucessoOperador,
                                                                        :nrContatoSucessoCampanha,
                                                                        :nrPublicoTotal,
                                                                        :nrAderiuOperador,
                                                                        :nrAderiuCampanha,
                                                                        :nrNaoAderiuOperador,
                                                                        :nrNaoAderiuCampanha,
                                                                        :idPessoaUsuarioAlteracao,
                                                                        sysdate);

		if (sqlca.sqlcode)
		{
			throw new TuxBasicSvcException("00E1000","INSERT INTO campanha.Parametrizacaocampanha");
		}

		/* insert OK */
		xml->createTag("CAMPANHA");
		xml->addItem("INSERT",1);
		xml->closeTag();
	}
	
        if(idGotcha > 0)
	{
            /* Update linha */
            EXEC SQL UPDATE campanha.Parametrizacaocampanha
                SET idcanalcampanha = :idGotcha,
                    nrtempomediocontato = :nrTempoMedioContato,
                    nrmetadiariacampanha = :nrMetaDiariaCampanha,
                    nrmetadiariaoperador = :nrMetaDiariaOperador,
                    nrcontatoefetivooperador = :nrContatoEfetivoOperador,
                    nrcontatoefetivocampanha = :nrContatoEfetivoCampanha,
                    nrcontatosucessooperador = :nrContatoSucessoOperador,
                    nrcontatosucessocampanha = :nrContatoSucessoCampanha,
                    nrpublicototal = :nrPublicoTotal,
                    nraderiuoperador = :nrAderiuOperador,
                    nraderiucampanha = :nrAderiuCampanha,
                    nrnaoaderiuoperador = :nrNaoAderiuOperador,
                    nrnaoaderiucampanha = :nrNaoAderiuCampanha,
                    idusuarioalteracao = :idPessoaUsuarioAlteracao,
                    dtultimaalteracao = sysdate
                WHERE idcanalcampanha = :idGotcha;

            if (sqlca.sqlcode)
            {
                throw new TuxBasicSvcException("00E1000","UPDATE apoio.campanha ");
            }
	    /* insert modificado para update OK */
	    xml->createTag("CAMPANHA");
	    xml->addItem("ID",idGotcha);
	    xml->addItem("UPDATE",1);
	    xml->closeTag();
	}
        idGotcha = 0;
