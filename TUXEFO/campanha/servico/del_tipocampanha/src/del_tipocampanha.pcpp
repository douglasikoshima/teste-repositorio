//
// $Id: del_tipocampanha.pcpp,v 1.1 2009/07/31 15:34:43 a5110702 Exp $
//

#include "../../negocio/cmputil/include/campanha.hpp"

int del_tipocampanha(char * usuario, DOMNode*dnode,XMLGen*xml)
{
	char parm[256];

	EXEC SQL BEGIN DECLARE SECTION;
		int		idTipoCampanha;
		int		inAtivo;
		int     idPessoaUsuarioAlteracao;
	EXEC SQL END DECLARE SECTION;
	EXEC SQL WHENEVER SQLERROR DO sql_error(NULL);

    //  Obtendo dados do xml

	get_tag(parm, dnode, "idTipoCampanha", 0, 0);
		idTipoCampanha = atoi(parm);
    
    //  Pegando id do usuario
	idPessoaUsuarioAlteracao = get_idUsuario(usuario);
	
	inAtivo = 0;

	/* Update linha */
	EXEC SQL UPDATE apoio.tipocampanha
	    SET inativo = :inAtivo,
		idPessoaUsuarioAlteracao = :idPessoaUsuarioAlteracao,
		dtAlteracao = sysdate
            WHERE idtipocampanha = :idTipoCampanha;

	if (sqlca.sqlcode)
	{
		throw new TuxBasicSvcException("00E1000","DELETE apoio.tipocampanha ");
	}

	/* update OK */
	xml->createTag("TIPOCAMPANHA");
		xml->addItem("DELETE",sqlca.sqlerrd[2]);
	xml->closeTag();

	return 1;
}
