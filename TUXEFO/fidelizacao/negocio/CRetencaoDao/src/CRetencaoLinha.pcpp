
#include <CRetencaoLinha.h>


int CRetencaoLinha::Inserir( DOMNode* pdnode, char* pidUser, char* pidRetencao )
{
    ULOG_START( "CRetencaoLinha::Inserir()" );

    char parm[255];
    parm[0] = 0x0;

    EXEC SQL BEGIN DECLARE SECTION;

        VARCHAR     idRetencao[21+1];
        VARCHAR		idLinhaTelefonica[21+1];
        VARCHAR		idUser[21+1];

    EXEC SQL END DECLARE SECTION;
     
    EXEC SQL WHENEVER SQLERROR DO sql_error( NULL );

    strToOra(idRetencao,pidRetencao);

    endOraStr(idRetencao);
    ULOG_VAR(idRetencao);

    get_tag(parm,pdnode,"idLinhaTelefonica",0,0); 
    strToOra(idLinhaTelefonica,parm);

    strToOra(idUser,pidUser);

    ULOG_VAR(idUser);

    EXEC SQL
    INSERT INTO RETENCAO.RETENCAOLINHA
    ( 
        idRetencaoLinha,
        idRetencao,
        idLinhaTelefonica,
        idPessoaUsuarioInclusao,
        dtInclusao,
        idPessoaUsuarioAlteracao,
        dtAlteracao,
        idUsuarioAlteracao,
        dtUltimaAlteracao 
    )
    VALUES 
    ( 
        retencao.retencaoLinhaSQ.nextval,
        :idRetencao,
        :idLinhaTelefonica,
        :idUser,
        SYSDATE,
        :idUser,
        SYSDATE,
        :idUser,
        SYSDATE 
    );

    ULOG_END( "CRetencaoLinha::Inserir()" );

    return 1;
}

