//
// $Id: sel_tpcli.pcpp,v 1.1 2009/07/31 15:33:42 a5110702 Exp $
//

#include "../../negocio/fidutil/include/retencao.hpp"

int sel_tpcli(DOMNode*dnode,XMLGen*xml)
{
    
  EXEC SQL BEGIN DECLARE SECTION;
    int     idTipoPessoa;
    VARCHAR dsTipoPessoa[255];
  EXEC SQL END DECLARE SECTION;
  EXEC SQL WHENEVER SQLERROR DO sql_error(NULL);
  EXEC SQL WHENEVER NOT FOUND DO break;

  try{
    EXEC SQL DECLARE crsCli CURSOR FOR
      select idTipoPessoa, dsTipoPessoa 
      from   apoio.TipoPessoa
	  order by dsTipoPessoa;
	  
	 
    EXEC SQL OPEN crsCli;

    for(;;) {
      EXEC SQL FETCH crsCli INTO :idTipoPessoa, :dsTipoPessoa;
      endOraStr(dsTipoPessoa);
      xml->createTag("tns:itemListaVO");
      xml->addItem("id",idTipoPessoa);
      xml->addItem("descricao",(char *)dsTipoPessoa.arr);
      xml->closeTag();
    }
  
    EXEC SQL CLOSE crsCli;
  }catch(...){throw;}
 
  return 1;
}

