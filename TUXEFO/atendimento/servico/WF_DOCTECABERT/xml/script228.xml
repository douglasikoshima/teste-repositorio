




//Imports;
#import WFDocumentoTecnico:WFDocTecIncluir;



//Definições;
string Usuario;
string txt;

string NrDoc;
string DtAbertura;
string DtEstFech;
string DsDoc;
string IdTpDoc;
string IdProced;


DOMNODE parametro;

XMLGen Saida;


Usuario = GetHdrData("user");

NrDoc = XML:nrDocumento;
DtAbertura = XML:dtAbertura;
DtEstFech = XML:dtEstimadaFechamento;
DsDoc = XML:dsDocumento;
IdTpDoc = XML:idTipoDocumentoProcesso;
IdProced = XML:idProcedencia;
      
      //;
      //************* Lista Todos os Tipos de Documentos ********************;
      //;

      txt  = "<AberturaDocumentoTecnicoVO>\n";
      txt += "<nrDocumento>" + NrDoc + "</nrDocumento>\n";
      txt += "<dtAbertura>" + DtAbertura + "</dtAbertura>\n";
      txt += "<dtEstimadaFechamento>" + DtEstFech + "</dtEstimadaFechamento>\n";
      txt += "<dsDocumento>" + DsDoc + "</dsDocumento>\n";
      txt += "<idDocumentoTecnicoTipo>" + IdTpDoc + "</idDocumentoTecnicoTipo>\n";
      txt += "<idProcedencia>" + IdProced + "</idProcedencia>\n";
      txt += "</AberturaDocumentoTecnicoVO>\n";
      
      parametro = txt;
      Saida = WFDocumentoTecnico.WFDocTecIncluir( parametro );
      
//;
//*** FIM DE PROCESSO ***;
//;

//Retorna processamento;
      Clean(txt);		
         txt = "<WFAcaoRetornoVO xmlns=\"workflow.fo.vivo.com.br/vo\">\n";
         txt += "<acaoExecucao>S</acaoExecucao>\n";
         txt += "<mensagem>Abertura de Documento Tecnico Efetuada</mensagem>\n";
         txt += "</WFAcaoRetornoVO>\n";
      return txt;


      

            