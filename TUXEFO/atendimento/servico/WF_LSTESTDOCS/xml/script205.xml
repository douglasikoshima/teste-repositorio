



#import WFAtdDocTecTipo:WFAtdDocTecTipoConsultar;
#import WFApoioProced:WFApoioProcedConsultar;


string Usuario;
string txt;
string idProcedencia;
string dsProcedencia;
string EstadoDoc;
string SaidaProc;

DOMNODE parametro;
DOMNODE domTmp;

XMLGen OUT;
XMLGen Procedencia;


Usuario = GetHdrData("user");
      
      OUT  = "<AtendimentoWorkflowTecnicoVO xmlns=\"workflow.fo.vivo.com.br/vo\" xmlns:ns2=\"admsistemas.fo.vivo.com.br/vo\">\n";

      txt  = "<ListaEstadoTipoDocumentoVO>\n";
      txt += "<order>" + "dsDocumentoTecnicoTipo" + "</order>\n";
      txt += "</ListaEstadoTipoDocumentoVO>\n";
      parametro = txt;
      OUT = WFAtdDocTecTipo.WFAtdDocTecTipoConsultar( parametro );

      EstadoDoc += "<WFDocumentoTecnicoEstadoVO>\n";
         EstadoDoc += "<idDocTecEstado>0</idDocTecEstado>\n";
         EstadoDoc += "<dsDocTecEstado>Aberto</dsDocTecEstado>\n";
      EstadoDoc += "</WFDocumentoTecnicoEstadoVO>\n";
      EstadoDoc += "<WFDocumentoTecnicoEstadoVO>\n";
         EstadoDoc += "<idDocTecEstado>1</idDocTecEstado>\n";
         EstadoDoc += "<dsDocTecEstado>Fechado</dsDocTecEstado>";
      EstadoDoc += "</WFDocumentoTecnicoEstadoVO>\n";

      OUT += EstadoDoc;

      Clean(txt);
      txt  = "<ListaEstadoTipoDocumentoVO>\n";
      txt += "<order>" + "dsProcedencia" + "</order>\n";
      txt += "</ListaEstadoTipoDocumentoVO>\n";
      parametro = txt;
      Procedencia = WFApoioProced.WFApoioProcedConsultar( parametro );

      while(domTmp=Procedencia:ProcedenciaVO)
         idProcedencia = domTmp:idProcedencia;
         dsProcedencia = domTmp:dsProcedencia;
         SaidaProc  += "<ns2:ProcedenciaVO>\n";
            SaidaProc += "<ns2:idProcedencia>" + idProcedencia + "</ns2:idProcedencia>\n";
            SaidaProc += "<ns2:descricao>" + dsProcedencia + "</ns2:descricao>\n";
         SaidaProc += "</ns2:ProcedenciaVO>\n";
         Clean(idProcedencia);
         Clean(dsProcedencia);
      loop;

      OUT += SaidaProc;
      
      OUT += "</AtendimentoWorkflowTecnicoVO>\n";

return OUT;

      

            