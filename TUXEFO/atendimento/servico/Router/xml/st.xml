<?xml version="1.0" encoding="ISO-8859-1"?>
<msg>
		<!-- This run only under UNIX -->
        <msgHdr>
                <user>TestUser</user>
                <service>CustomService</service>
        </msgHdr>
        <msgBody>
                <script type="B">
                        <![CDATA[
XMLGen xml;
DOMNODE dom;
DOMNODE sub;
string str;
int isfirst;

str = "<about>\n\t<signature>"+SSIGN+"</signature>\n\t<version>"+SVERSION+"</version>\n\t";
str += "<so>"+SSO+"</so>\n\t<build>"+SMAJOR+"."+SMINOR+"."+SBUILD+"-"+STYPE+"</build>\n";
str += "</about>";

xml=str;
xml+="<Test data=\"http://usr.com\"/>";
xml+="<step>Calling External Function</step>";
dom=XML:loop;
isfirst=1;
xml="<step>Test Loop and If startments</step>";
str="<analyser>\n";
while(sub=dom:data)
        if(!isfirst)
                str+="\n";
        else
                isfirst=0;
        fi;
		str+="\t<customer>\n";
        str+="\t\t<idNbr>" + sub:id + "</idNbr>\n";
        str+="\t\t<personNm>" + sub:name + "</personNm>\n";
		str+="\t</customer>";
loop;

str += "\n</analyser>";

xml+=str;
dom=xml;

while(sub=dom:analyser)
        str+="\n<TestResult>Success</TestResult>";
loop;

xml+="<step>Testing cast from DOMNODE to XMLGEN</step>";
sub=XML:data;
str+="\n<person>\n\t<id>" + sub:id + "</id>\n\t<person>" + sub:person + "</person>";
str+="\n</person>\n";

xml+="<step>Retrieve Columns from database</step>";
SQL SELECT 'Column #1'Col1,'Column #2'Col2 FROM DUAL;
if(SQL0)
	str += "<DB>\n";
	str += "\t<Col1>\"" + Col1 + "\"</Col1>\n\t<Col2>\"" + Col2 + "\"</Col2>";
	str += "\n</DB>";
else
	str += "</DB>";
fi;

xml+=str;


str = "%" + XML:help + "%";
SQL SELECT topic,seq,info FROM system.help WHERE info LIKE :str;
if(SQL1)
	str =  "<ORAHelp>\n\t<item>\n\t\t<topic>" + topic + "</topic>";
	str += "\n\t\t<seq>" + seq + "</seq>\n\t\t<info>" + info + "</info>";
	str += "\n\t</item>\n<ORAHelp>";
else
	str = "<ORAHelp/>";
fi;

xml+=str;

return xml;
                        ]]>
                </script>
                <rsBody>
                        <data>
                                <id>1234</id>
                                <person>Customer</person>
                        </data>
                        <loop>
                                <data>
                                        <id>1</id>
                                        <name>Customer #1</name>
                                </data>
                                <data>
                                        <id>2</id>
                                        <name>Customer #2</name>
                                </data>
                                <data>
                                        <id>3</id>
                                        <name>Customer #3</name>
                                </data>
                        </loop>
						<query>
							<help>WHENEVER SQLERROR {EXI</help>
						</query>
                </rsBody>
        </msgBody>
</msg>
