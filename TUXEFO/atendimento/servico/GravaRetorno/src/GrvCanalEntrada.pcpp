#undef SQLCA
#define SQLCA_NONE

#include <sqlca.h>
#include <sqlda.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <tuxfw.h>


int InsereCanalEntrada( long idRetParam, long * idCanalPrm )
{
    ULOG_START("InsereCanalEntrada()");
    int i=0;
    //INITIALIZE_SQL;
    struct sqlca sqlca;

    EXEC SQL BEGIN DECLARE SECTION;

			long  idCanal;
			long  idTipoRetornoContato;
			
    EXEC SQL END DECLARE SECTION;
    
    sqlca.sqlcode = -1;
	

    EXEC SQL WHENEVER SQLERROR GOTO UndefinedError;
     for ( i=0; i<500 ; i++ )
    {
        if ( idCanalPrm[i] == -1L )
            break;

        idCanal = idCanalPrm[i];
        idTipoRetornoContato = idRetParam;

        ULOG( "Canal: %ul",  idCanal);
	     ULOG( "idTipoRetornoContato: %ul",  idTipoRetornoContato);

    
		EXEC SQL 
		   INSERT INTO ContatoAdm.ContatoTipoRetornoCanal 
   			(
   			  idContatoTipoRetornoCanal , 
   			  idContatoTipoRetorno , 
   			  idCanal 
   			)
   		VALUES
   			( 
   			  ContatoAdm.ContatoTipoRetornoCanalSQ.nextval ,
   			  :idTipoRetornoContato, 
   			  :idCanal
   			);
   			

		if( sqlca.sqlcode )
		{
		   ULOG_END("InsereCanalEntrada()");
			return 0;
		}
    }
    ULOG_END("InsereCanalEntrada()");
    return 1;

UndefinedError:
        throw new TuxBasicOraException( sqlca.sqlcode,
                                        sqlca.sqlerrm.sqlerrmc,
                                        sqlca.sqlerrm.sqlerrml
                                      );
			
}

