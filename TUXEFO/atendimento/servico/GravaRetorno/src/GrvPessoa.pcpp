#undef SQLCA
#define SQLCA_NONE

#include <sqlca.h>
#include <sqlda.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <tuxfw.h>



int InserePessoa( long idRetParam, long * idTipoPessoaPrm )
{
   ULOG_START("InserePessoa()");
	struct sqlca sqlca;

	int i=0;
	EXEC SQL BEGIN DECLARE SECTION;

			long  idTipoPessoa;
			long  idTipoRetornoContato;
			
	EXEC SQL END DECLARE SECTION;


   sqlca.sqlcode = -1;
      
   EXEC SQL WHENEVER SQLERROR GOTO UndefinedError;
     for ( i=0; i<500 ; i++ )
    {
        if ( idTipoPessoaPrm[i] == -1L )
            break;

        idTipoPessoa = idTipoPessoaPrm[i];
        idTipoRetornoContato = idRetParam;

    

		EXEC SQL 
		   INSERT INTO ContatoAdm.TipoRetornoTipoPessoa 
   			(
   			   idTipoRetornoTipoPessoa , 
   			   idContatoTipoRetorno , 
   			   idTipoPessoa 
   			)
   		VALUES
   			( 
   			   ContatoAdm.TipoRetornoTipoPessoaSQ.nextval ,
   			   :idTipoRetornoContato, 
   			   :idTipoPessoa
   			);
   			
   		if( sqlca.sqlcode )
   		{
   		    ULOG_END("InserePessoa()");
			    return 0;
			}
    }
    ULOG_END("InserePessoa()");
    return 1;

UndefinedError:
        throw new TuxBasicOraException( sqlca.sqlcode,
                                        sqlca.sqlerrm.sqlerrmc,
                                        sqlca.sqlerrm.sqlerrml
                                      );
			
}
