======================================
BATCH......: documentoOfertaSGP
Alterado por: Lucas Gomes(29/09/2015)
Funcional..: Dener Neves dos Santos
======================================

====================================== 
OBJETIVO
====================================== 
	O propósito deste documento é coletar, analisar e definir os requisitos de Software
	Funcionais, não Funcionais e detalhar a Solução técnica da Base CRM, impactada na 
	demanda.
====================================== 

====================================== 
ESCOPO
====================================== 
	Este documento descreve os requisitos funcionais e não funcionais de software e 
	solução necessários para disponibilizar informações da BASE CRM (Camada de 
	Apresentação documento Oferta SGP) na busca pelo Vivo 360, para rápidas buscas. 
====================================== 

====================================== 
SOBRE ESTE BATCH
====================================== 



====================================== 


======================================
SCRIPT DE CRIAÇÃO DA TABELA EM DESENVOLVIMENTO 
====================================== 


/*
CREATE TABLESPACE TBS_CUSTOMER_PD1;
CREATE TABLESPACE TBS_CUSTOMER_PD2;
CREATE TABLESPACE TBS_CUSTOMER_PD3;
CREATE TABLESPACE TBS_CUSTOMER_PD4;
CREATE TABLESPACE TBS_CUSTOMER_PD5;
CREATE TABLESPACE TBS_CUSTOMER_PD6;
CREATE TABLESPACE TBS_CUSTOMER_PD7;
CREATE TABLESPACE TBS_CUSTOMER_PD8;
*/

CREATE TABLE CUSTOMER.DOCUMENTOOFERTASGP
(
  NRDOCUMENTO VARCHAR2(255 BYTE) NOT NULL
)
LOGGING
PARTITION BY HASH (NRDOCUMENTO)
(  
  PARTITION P1 TABLESPACE TBS_DADOS,  
  PARTITION P2 TABLESPACE TBS_DADOS,  
  PARTITION P3 TABLESPACE TBS_DADOS,  
  PARTITION P4 TABLESPACE TBS_DADOS,  
  PARTITION P5 TABLESPACE TBS_DADOS,  
  PARTITION P6 TABLESPACE TBS_DADOS,  
  PARTITION P7 TABLESPACE TBS_DADOS,  
  PARTITION P8 TABLESPACE TBS_DADOS,  
  PARTITION P9 TABLESPACE TBS_DADOS,  
  PARTITION P10 TABLESPACE TBS_DADOS,  
  PARTITION P11 TABLESPACE TBS_DADOS,  
  PARTITION P12 TABLESPACE TBS_DADOS,  
  PARTITION P13 TABLESPACE TBS_DADOS,  
  PARTITION P14 TABLESPACE TBS_DADOS,  
  PARTITION P15 TABLESPACE TBS_DADOS,  
  PARTITION P16 TABLESPACE TBS_DADOS,  
  PARTITION P17 TABLESPACE TBS_DADOS,  
  PARTITION P18 TABLESPACE TBS_DADOS,  
  PARTITION P19 TABLESPACE TBS_DADOS,  
  PARTITION P20 TABLESPACE TBS_DADOS,  
  PARTITION P21 TABLESPACE TBS_DADOS,  
  PARTITION P22 TABLESPACE TBS_DADOS,  
  PARTITION P23 TABLESPACE TBS_DADOS,  
  PARTITION P24 TABLESPACE TBS_DADOS,  
  PARTITION P25 TABLESPACE TBS_DADOS,  
  PARTITION P26 TABLESPACE TBS_DADOS,  
  PARTITION P27 TABLESPACE TBS_DADOS,  
  PARTITION P28 TABLESPACE TBS_DADOS,  
  PARTITION P29 TABLESPACE TBS_DADOS,  
  PARTITION P30 TABLESPACE TBS_DADOS,  
  PARTITION P31 TABLESPACE TBS_DADOS,  
  PARTITION P32 TABLESPACE TBS_DADOS
)
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING
ENABLE ROW MOVEMENT;

COMMENT ON TABLE CUSTOMER.DOCUMENTOOFERTASGP IS 'REGISTRA DOCUMENTOS PARA OFERTA';
COMMENT ON COLUMN CUSTOMER.DOCUMENTOOFERTASGP.NRDOCUMENTO IS 'NUMERO DO DOCUMENTO PARA OFERTA';

CREATE INDEX CUSTOMER.DOCUMENTOOFERTASGPIE ON CUSTOMER.DOCUMENTOOFERTASGP (NRDOCUMENTO)
LOGGING
LOCAL (  
  PARTITION P1 TABLESPACE TBS_INDICES,  
  PARTITION P2 TABLESPACE TBS_INDICES,  
  PARTITION P3 TABLESPACE TBS_INDICES,  
  PARTITION P4 TABLESPACE TBS_INDICES,  
  PARTITION P5 TABLESPACE TBS_INDICES,  
  PARTITION P6 TABLESPACE TBS_INDICES,  
  PARTITION P7 TABLESPACE TBS_INDICES,  
  PARTITION P8 TABLESPACE TBS_INDICES,  
  PARTITION P9 TABLESPACE TBS_INDICES,  
  PARTITION P10 TABLESPACE TBS_INDICES,
  PARTITION P11 TABLESPACE TBS_INDICES,  
  PARTITION P12 TABLESPACE TBS_INDICES,  
  PARTITION P13 TABLESPACE TBS_INDICES,  
  PARTITION P14 TABLESPACE TBS_INDICES,  
  PARTITION P15 TABLESPACE TBS_INDICES,  
  PARTITION P16 TABLESPACE TBS_INDICES,  
  PARTITION P17 TABLESPACE TBS_INDICES,  
  PARTITION P18 TABLESPACE TBS_INDICES,  
  PARTITION P19 TABLESPACE TBS_INDICES,  
  PARTITION P20 TABLESPACE TBS_INDICES,  
  PARTITION P21 TABLESPACE TBS_INDICES,  
  PARTITION P22 TABLESPACE TBS_INDICES,  
  PARTITION P23 TABLESPACE TBS_INDICES,  
  PARTITION P24 TABLESPACE TBS_INDICES,  
  PARTITION P25 TABLESPACE TBS_INDICES,  
  PARTITION P26 TABLESPACE TBS_INDICES,  
  PARTITION P27 TABLESPACE TBS_INDICES,  
  PARTITION P28 TABLESPACE TBS_INDICES,  
  PARTITION P29 TABLESPACE TBS_INDICES,  
  PARTITION P30 TABLESPACE TBS_INDICES,  
  PARTITION P31 TABLESPACE TBS_INDICES,  
  PARTITION P32 TABLESPACE TBS_INDICES
)
NOPARALLEL;

DROP PUBLIC SYNONYM DOCUMENTOOFERTASGP;
CREATE PUBLIC SYNONYM DOCUMENTOOFERTASGP FOR CUSTOMER.DOCUMENTOOFERTASGP;

GRANT SELECT ON CUSTOMER.DOCUMENTOOFERTASGP TO NFO_OW WITH GRANT OPTION;
--GRANT DELETE, INSERT, SELECT, UPDATE ON CUSTOMER.DOCUMENTOOFERTASGP TO BATCHPRO;

/****************************TESTE***************************/
GRANT DELETE, INSERT, SELECT, UPDATE ON CUSTOMER.DOCUMENTOOFERTASGP TO INDRALOG;
/***************************TESTE***************************/

CREATE OR REPLACE PROCEDURE CUSTOMER.PRC_TRUNC_DOCUMENTOOFERTASGP
(
	VO_CDERRO OUT NUMBER,
	VO_DSERRO OUT VARCHAR2
)
IS
BEGIN
	VO_CDERRO := 0;
	VO_DSERRO := 'Sucesso';

	EXECUTE IMMEDIATE 'TRUNCATE TABLE CUSTOMER.DOCUMENTOOFERTASGP';
	COMMIT;
EXCEPTION
     WHEN OTHERS THEN
       VO_CDERRO := 1;
	   VO_DSERRO := 'ERRO NR.: ' || SQLCODE || ' - DESCRIÇÃO DO ERRO: ' || SQLERRM;
END PRC_TRUNC_DOCUMENTOOFERTASGP; 

--GRANT EXECUTE ON CUSTOMER.PRC_TRUNC_DOCUMENTOOFERTASGP TO BATCHPRO;
GRANT EXECUTE ON CUSTOMER.PRC_TRUNC_DOCUMENTOOFERTASGP TO INDRALOG;

CREATE OR REPLACE PROCEDURE NFO_OW.nfo_buscardadosbasicospessoa (
   vi_idpessoa                        IN  customer.pessoa.idpessoa%TYPE,
   VI_IDPESSOASISTEMAORIGEM           IN  customer.pessoa.idpessoasistemaorigem%TYPE,
   VI_SGSISTEMAORIGEM                 IN  apoio.sistemaorigem.SGSISTEMAORIGEM%TYPE,
   vo_idsistemaorigem                 OUT customer.pessoa.idsistemaorigem%TYPE,
   vo_idpessoasistemaorigem           OUT customer.pessoa.idpessoasistemaorigem%TYPE,
   vo_nmpessoa                        OUT customer.pessoa.nmpessoa%TYPE,
   vo_nmnome                          OUT customer.pessoa.nmnome%TYPE,
   vo_nmnomemeio                      OUT customer.pessoa.nmnomemeio%TYPE,
   vo_nmsobrenome                     OUT customer.pessoa.nmsobrenome%TYPE,
   vo_dtchurn                         OUT customer.pessoa.dtchurn%TYPE,
   vo_dtcadastro                      OUT customer.pessoa.dtcadastro%TYPE,
   vo_infalecimentoinformado          OUT customer.pessoa.infalecimentoinformado%TYPE,
   vo_dtfalecimento                   OUT customer.pessoa.dtfalecimento%TYPE,
   vo_idtipopessoa                    OUT customer.pessoa.idtipopessoa%TYPE,
   vo_tssincronismo                   OUT customer.pessoa.tssincronismo%TYPE,
   vo_sqsincronismo                   OUT customer.pessoa.sqsincronismo%TYPE,
   vo_idtipocarteira                  OUT customer.pessoa.idtipocarteira%TYPE,
   vo_iduf                            OUT customer.pessoa.iduf%TYPE,
   vo_vlrchurnprobabilidade           OUT customer.pessoa.vlrchurnprobabilidade%TYPE,
   vo_dttipocarteira                  OUT customer.pessoa.dttipocarteira%TYPE,
   vo_idprobinadimplencia             OUT customer.pessoa.idprobinadimplencia%TYPE,
   vo_idchurnprobabilidade            OUT customer.pessoa.idchurnprobabilidade%TYPE,
   vo_dscargocontato                  OUT customer.pessoa.dscargocontato%TYPE,
   vo_dsdeptocontato                  OUT customer.pessoa.dsdeptocontato%TYPE,
   vo_idusuarioalteracao              OUT customer.pessoa.idusuarioalteracao%TYPE,
   vo_dtultimaalteracao               OUT customer.pessoa.dtultimaalteracao%TYPE,
   vo_idpessoadepara                  OUT customer.pessoadepara.idpessoadepara%TYPE,
   vo_idpessoaorigem                  OUT customer.pessoadepara.idpessoaorigem%TYPE,
   vo_sgsistemaorigem                 OUT apoio.sistemaorigem.sgsistemaorigem%TYPE,
   vo_nmsistemaorigem                 OUT apoio.sistemaorigem.nmsistemaorigem%TYPE,
   vo_indisponivel                    OUT apoio.sistemaorigem.indisponivel%TYPE,
   vo_sgtipopessoa                    OUT apoio.tipopessoa.sgtipopessoa%TYPE,
   vo_dstipopessoa                    OUT apoio.tipopessoa.dstipopessoa%TYPE,
   vo_sgtipocarteira                  OUT apoio.tipocarteira.sgtipocarteira%TYPE,
   vo_dstipocarteira                  OUT apoio.tipocarteira.dstipocarteira%TYPE,
   vo_vlpeso                          OUT apoio.tipocarteira.vlpeso%TYPE,
   vo_incorporativo                   OUT apoio.tipocarteira.incorporativo%TYPE,
   vo_sguf                            OUT apoio.uf.sguf%TYPE,
   vo_nmuf                            OUT apoio.uf.nmuf%TYPE,
   vo_nrfusohorario                   OUT apoio.uf.nrfusohorario%TYPE,
   vo_inpreenchelistaout              OUT apoio.uf.inpreenchelista%TYPE,
   vo_dsprobinadimplencia             OUT apoio.probabilidade.dsprobabilidade%TYPE,
   vo_sgprobinadimplencia             OUT apoio.probabilidade.sgprobabilidade%TYPE,
   vo_vlpesoprobinadimplencia         OUT apoio.probabilidade.vlpeso%TYPE,
   vo_dsprobabilidadechurn            OUT apoio.probabilidade.dsprobabilidade%TYPE,
   vo_sgprobabilidadechurn            OUT apoio.probabilidade.sgprobabilidade%TYPE,
   vo_vlpesoprobchurn                 OUT apoio.probabilidade.vlpeso%TYPE,
   vo_dtnascimento                    OUT customer.pessoafisica.dtnascimento%TYPE,
   vo_nmmae                           OUT customer.pessoafisica.nmmae%TYPE,
   vo_nmpai                           OUT customer.pessoafisica.nmpai%TYPE,
   vo_idtratamento                    OUT customer.pessoafisica.idtratamento%TYPE,
   vo_idestadocivil                   OUT customer.pessoafisica.idestadocivil%TYPE,
   vo_idpais                          OUT customer.pessoafisica.idpais%TYPE,
   vo_idsexo                          OUT customer.pessoafisica.idsexo%TYPE,
   vo_sgtratamento                    OUT apoio.tratamento.sgtratamento%TYPE,
   vo_dstratamento                    OUT apoio.tratamento.dstratamento%TYPE,
   vo_sgestadocivil                   OUT apoio.estadocivil.sgestadocivil%TYPE,
   vo_dsestadocivil                   OUT apoio.estadocivil.dsestadocivil%TYPE,
   vo_sgpais                          OUT apoio.pais.sgpais%TYPE,
   vo_nmpais                          OUT apoio.pais.nmpais%TYPE,
   vo_dsnacionalidade                 OUT apoio.pais.dsnacionalidade%TYPE,
   vo_inpreenchelista                 OUT apoio.pais.inpreenchelista%TYPE,
   vo_sgsexo                          OUT apoio.sexo.sgsexo%TYPE,
   vo_dssexo                          OUT apoio.sexo.dssexo%TYPE,
   vo_nmpessoafilial                  OUT customer.pessoajuridica.nmpessoafilial%TYPE,
   vo_nmfantasia                      OUT customer.pessoajuridica.nmfantasia%TYPE,
   vo_dtfundacao                      OUT customer.pessoajuridica.dtfundacao%TYPE,
   vo_idcfop                          OUT customer.pessoajuridica.idcfop%TYPE,
   vo_dscfop                          OUT apoio.cfop.dscfop%TYPE,
   vo_sgcfop                          OUT apoio.cfop.sgcfop%TYPE,
   vo_incliente                       OUT NUMBER,
   vo_qtalteracao                     OUT customer.pessoa.qtalteracao%TYPE,
   vo_tpresponsabilidade              OUT VARCHAR2,
   vo_idpessoadocumento               OUT customer.pessoadocumento.idpessoadocumento%TYPE,
   vo_iddocumento                     OUT customer.pessoadocumento.iddocumento%TYPE,
   vo_tssincronismopd                 OUT customer.pessoadocumento.tssincronismo%TYPE,
   vo_sqsincronismopd                 OUT customer.pessoadocumento.sqsincronismo%TYPE,
   vo_idsistemaorigempd               OUT customer.pessoadocumento.idsistemaorigem%TYPE,
   vo_iddocumentosistemaorigem        OUT customer.pessoadocumento.iddocumentosistemaorigem%TYPE,
   vo_dtexpiracao                     OUT customer.pessoadocumento.dtexpiracao%TYPE,
   vo_idusuarioalteracaopd            OUT customer.pessoadocumento.idusuarioalteracao%TYPE,
   vo_dtultimaalteracaopd             OUT customer.pessoadocumento.dtultimaalteracao%TYPE,
   vo_sgsistemaorigempd               OUT apoio.sistemaorigem.sgsistemaorigem%TYPE,
   vo_nmsistemaorigempd               OUT apoio.sistemaorigem.nmsistemaorigem%TYPE,
   vo_indisponivelpd                  OUT apoio.sistemaorigem.indisponivel%TYPE,
   vo_cdcpfcnpjbase                   OUT customer.documento.cdcpfcnpjbase%TYPE,
   vo_cdcnpjfilial                    OUT customer.documento.cdcnpjfilial%TYPE,
   vo_cdcpfcnpjcontrole               OUT customer.documento.cdcpfcnpjcontrole%TYPE,
   vo_nrdocumento                     OUT customer.documento.nrdocumento%TYPE,
   vo_sgorgaoexpedidor                OUT customer.documento.sgorgaoexpedidor%TYPE,
   vo_dtemissao                       OUT customer.documento.dtemissao%TYPE,
   vo_idpaispd                        OUT customer.documento.idpais%TYPE,
   vo_idufpd                          OUT customer.documento.iduf%TYPE,
   vo_idtipodocumento                 OUT customer.documento.idtipodocumento%TYPE,
   vo_idusuarioalteracaodoc           OUT customer.documento.idusuarioalteracao%TYPE,
   vo_dtultimaalteracaodoc            OUT customer.documento.dtultimaalteracao%TYPE,
   vo_sgpaispd                        OUT apoio.pais.sgpais%TYPE,
   vo_nmpaispd                        OUT apoio.pais.nmpais%TYPE,
   vo_dsnacionalidadepd               OUT apoio.pais.dsnacionalidade%TYPE,
   vo_inpreenchelistapd               OUT apoio.pais.inpreenchelista%TYPE,
   vo_sgufpd                          OUT apoio.uf.sguf%TYPE,
   vo_nmufpd                          OUT apoio.uf.nmuf%TYPE,
   vo_nrfusohorariopd                 OUT apoio.uf.nrfusohorario%TYPE,
   vo_inpreenchelistaoutpd            OUT apoio.uf.inpreenchelista%TYPE,
   vo_sgtipodocumento                 OUT apoio.tipodocumento.sgtipodocumento%TYPE,
   vo_dstipodocumento                 OUT apoio.tipodocumento.dstipodocumento%TYPE,
   vo_idtipopessoapd                  OUT apoio.tipodocumento.idtipopessoa%TYPE,
   vo_nrprioridade                    OUT apoio.tipodocumento.nrprioridade%TYPE,
   vo_sgclassificacao                 OUT apoio.tipodocumento.sgclassificacao%TYPE,
   vo_invisualiza                     OUT apoio.tipodocumento.invisualiza%TYPE,
   vo_idpessoacomunicacao             OUT customer.pessoacomunicacao.idpessoacomunicacao%TYPE,
   vo_idtipocomunicacao               OUT customer.pessoacomunicacao.idtipocomunicacao%TYPE,
   vo_nrsequencia                     OUT customer.pessoacomunicacao.nrsequencia%TYPE,
   vo_dscontato                       OUT customer.pessoacomunicacao.dscontato%TYPE,
   vo_dtcadastropc                    OUT customer.pessoacomunicacao.dtcadastro%TYPE,
   vo_tssincronismopc                 OUT customer.pessoacomunicacao.tssincronismo%TYPE,
   vo_sqsincronismopc                 OUT customer.pessoacomunicacao.sqsincronismo%TYPE,
   vo_idsistemaorigempc               OUT customer.pessoacomunicacao.idsistemaorigem%TYPE,
   vo_idcomunicacaosistemaorigem      OUT customer.pessoacomunicacao.idcomunicacaosistemaorigem%TYPE,
   vo_dtexpiracaopc                   OUT customer.pessoacomunicacao.dtexpiracao%TYPE,
   vo_incomunicacaopreferencial       OUT customer.pessoacomunicacao.incomunicacaopreferencial%TYPE,
   vo_idusuarioalteracaopc            OUT customer.pessoacomunicacao.idusuarioalteracao%TYPE,
   vo_dtultimaalteracaopc             OUT customer.pessoacomunicacao.dtultimaalteracao%TYPE,
   vo_nmcontato                       OUT customer.pessoacomunicacao.nmcontato%TYPE,
   vo_sgsistemaorigempc               OUT apoio.sistemaorigem.sgsistemaorigem%TYPE,
   vo_nmsistemaorigempc               OUT apoio.sistemaorigem.nmsistemaorigem%TYPE,
   vo_indisponivelpc                  OUT apoio.sistemaorigem.indisponivel%TYPE,
   vo_sgtipocomunicacao               OUT apoio.tipocomunicacao.sgtipocomunicacao%TYPE,
   vo_dstipocomunicacao               OUT apoio.tipocomunicacao.dstipocomunicacao%TYPE,
   vo_idformaretorno                  OUT apoio.tipocomunicacao.idformaretorno%TYPE,
   vo_sgclassificacaopc               OUT apoio.tipocomunicacao.sgclassificacao%TYPE,
   vo_idsegmentacao                   OUT customer.pessoasegmentacaohistorico.idsegmentacao%TYPE,
   vo_vlrentabilidade                 OUT customer.pessoasegmentacaohistorico.vlrentabilidade%TYPE,
   vo_dtsegmentacao                   OUT customer.pessoasegmentacaohistorico.dtsegmentacao%TYPE,
   vo_dtrentabilidade                 OUT customer.pessoasegmentacaohistorico.dtrentabilidade%TYPE,
   vo_idusuarioalteracaops            OUT customer.pessoasegmentacaohistorico.idusuarioalteracao%TYPE,
   vo_dtultimaalteracaops             OUT customer.pessoasegmentacaohistorico.dtultimaalteracao%TYPE,
   vo_sgsegmentacao                   OUT apoio.segmentacao.sgsegmentacao%TYPE,
   vo_dssegmentacao                   OUT apoio.segmentacao.dssegmentacao%TYPE,
   vo_vlpesops                        OUT apoio.segmentacao.vlpeso%TYPE,
   vo_idtipocarteirapf                OUT apoio.segmentacao.idtipocarteirapf%TYPE,
   vo_inprogrelacionamento            OUT NUMBER,
   vo_possuiofertadisponivel          OUT linha.linhaoferta.cdarearegistro%TYPE,
   vo_cderro                          OUT NUMBER,
   vo_dserro                          OUT VARCHAR2)
/******************************************************************************
NAME:       NFO_BUSCARDADOSBASICOSPESSOA
PURPOSE:    Buscar através das 03 APIs (NFO_BUSCAPESSOADOCUMENTOPRIOR
NFO_BUSCAPESSOACOMUNICAPRIOR,NFO_BUSCAPESSOASEGMENTACAO) os dados básicos de uma determinada pessoa.


REVISIONS:
Ver        Date        Author           Description
---------  ----------  ---------------  ------------------------------------
1.0        15/12/2010  Indra            Criacao da procedure
1.1        01/08/2011  Indra           Incluido novo elemento de saidaVO_INPROGRELACIONAMENTO.
1.2        18/09/2013  Decio           Alteracao do COUNT Linha.LinhaConta
1.3        17/09/2014  Williams Santos Alteracao para inclusao de 2 novos parametros - 125693
1.4        29/09/2014  Lucas Moraes    Alterando tabela de oferta, para nova busca por documento
NOTES:

*****************************************************************************/
IS
   w_cderro   NUMBER;
   w_dserro   VARCHAR2 (2000);
   V_IDPESSOA customer.pessoa.idpessoa%TYPE;
   ex_idpessoa_nao_informado EXCEPTION;
BEGIN
   vo_cderro := 0;
   vo_dserro := 'Sucesso';

   IF (vi_idpessoa is null) THEN
    IF (VI_IDPESSOASISTEMAORIGEM IS NULL AND VI_SGSISTEMAORIGEM IS NULL) THEN
        RAISE ex_idpessoa_nao_informado;
    ELSIF (VI_IDPESSOASISTEMAORIGEM IS NULL OR VI_SGSISTEMAORIGEM IS NULL) THEN
         RAISE INVALID_NUMBER;
    ELSE
        SELECT P.IDPESSOA
          INTO V_IDPESSOA
          FROM customer.pessoa p
             , apoio.sistemaorigem so
         WHERE p.IDPESSOASISTEMAORIGEM = VI_IDPESSOASISTEMAORIGEM
           AND so.SGSISTEMAORIGEM = VI_SGSISTEMAORIGEM
           AND p.IDSISTEMAORIGEM = so.IDSISTEMAORIGEM;

    END IF;
   ELSE
        V_IDPESSOA := vi_idpessoa;
   END IF;

   --EXECUTANDO NFO_BUSCAPESSOA
   nfo_buscapessoa (V_IDPESSOA,
                    vo_idsistemaorigem,
                    vo_idpessoasistemaorigem,
                    vo_nmpessoa,
                    vo_nmnome,
                    vo_nmnomemeio,
                    vo_nmsobrenome,
                    vo_dtchurn,
                    vo_dtcadastro,
                    vo_infalecimentoinformado,
                    vo_dtfalecimento,
                    vo_idtipopessoa,
                    vo_tssincronismo,
                    vo_sqsincronismo,
                    vo_idtipocarteira,
                    vo_iduf,
                    vo_vlrchurnprobabilidade,
                    vo_dttipocarteira,
                    vo_idprobinadimplencia,
                    vo_idchurnprobabilidade,
                    vo_dscargocontato,
                    vo_dsdeptocontato,
                    vo_idusuarioalteracao,
                    vo_dtultimaalteracao,
                    vo_idpessoadepara,
                    vo_idpessoaorigem,
                    vo_sgsistemaorigem,
                    vo_nmsistemaorigem,
                    vo_indisponivel,
                    vo_sgtipopessoa,
                    vo_dstipopessoa,
                    vo_sgtipocarteira,
                    vo_dstipocarteira,
                    vo_vlpeso,
                    vo_incorporativo,
                    vo_sguf,
                    vo_nmuf,
                    vo_nrfusohorario,
                    vo_inpreenchelistaout,
                    vo_dsprobinadimplencia,
                    vo_sgprobinadimplencia,
                    vo_vlpesoprobinadimplencia,
                    vo_dsprobabilidadechurn,
                    vo_sgprobabilidadechurn,
                    vo_vlpesoprobchurn,
                    vo_dtnascimento,
                    vo_nmmae,
                    vo_nmpai,
                    vo_idtratamento,
                    vo_idestadocivil,
                    vo_idpais,
                    vo_idsexo,
                    vo_sgtratamento,
                    vo_dstratamento,
                    vo_sgestadocivil,
                    vo_dsestadocivil,
                    vo_sgpais,
                    vo_nmpais,
                    vo_dsnacionalidade,
                    vo_inpreenchelista,
                    vo_sgsexo,
                    vo_dssexo,
                    vo_nmpessoafilial,
                    vo_nmfantasia,
                    vo_dtfundacao,
                    vo_idcfop,
                    vo_dscfop,
                    vo_sgcfop,
                    vo_incliente,
                    vo_qtalteracao,
                    vo_tpresponsabilidade,
                    vo_cderro,
                    vo_dserro);

   IF vo_cderro = 0
   THEN
      --EXECUTANDO NFO_BUSCAPESSOADOCUMENTOPRIOR
      nfo_buscapessoadocumentoprior (V_IDPESSOA,
                                     vo_idpessoadocumento,
                                     vo_iddocumento,
                                     vo_tssincronismopd,
                                     vo_sqsincronismopd,
                                     vo_idsistemaorigempd,
                                     vo_iddocumentosistemaorigem,
                                     vo_dtexpiracao,
                                     vo_idusuarioalteracaopd,
                                     vo_dtultimaalteracaopd,
                                     vo_sgsistemaorigempd,
                                     vo_nmsistemaorigempd,
                                     vo_indisponivelpd,
                                     vo_cdcpfcnpjbase,
                                     vo_cdcnpjfilial,
                                     vo_cdcpfcnpjcontrole,
                                     vo_nrdocumento,
                                     vo_sgorgaoexpedidor,
                                     vo_dtemissao,
                                     vo_idpaispd,
                                     vo_idufpd,
                                     vo_idtipodocumento,
                                     vo_idusuarioalteracaodoc,
                                     vo_dtultimaalteracaodoc,
                                     vo_sgpaispd,
                                     vo_nmpaispd,
                                     vo_dsnacionalidadepd,
                                     vo_inpreenchelistapd,
                                     vo_sgufpd,
                                     vo_nmufpd,
                                     vo_nrfusohorariopd,
                                     vo_inpreenchelistaoutpd,
                                     vo_sgtipodocumento,
                                     vo_dstipodocumento,
                                     vo_idtipopessoapd,
                                     vo_nrprioridade,
                                     vo_sgclassificacao,
                                     vo_invisualiza,
                                     vo_cderro,
                                     vo_dserro);

      IF vo_cderro = 2
      THEN                      -- DADOS NÃO ENCONTRADOS - ERRO NÃO IMPEDITIVO
         vo_cderro := 0;
         vo_dserro := 'Sucesso';
      END IF;
   END IF;

   IF vo_cderro = 0
   THEN
      --EXECUTANDO NFO_BUSCAPESSOACOMUNICAPRIOR
      nfo_buscapessoacomunicaprior (V_IDPESSOA,
                                    vo_idpessoacomunicacao,
                                    vo_idtipocomunicacao,
                                    vo_nrsequencia,
                                    vo_dscontato,
                                    vo_dtcadastropc,
                                    vo_tssincronismopc,
                                    vo_sqsincronismopc,
                                    vo_idsistemaorigempc,
                                    vo_idcomunicacaosistemaorigem,
                                    vo_dtexpiracaopc,
                                    vo_incomunicacaopreferencial,
                                    vo_idusuarioalteracaopc,
                                    vo_dtultimaalteracaopc,
                                    vo_nmcontato,
                                    vo_sgsistemaorigempc,
                                    vo_nmsistemaorigempc,
                                    vo_indisponivelpc,
                                    vo_sgtipocomunicacao,
                                    vo_dstipocomunicacao,
                                    vo_idformaretorno,
                                    vo_sgclassificacaopc,
                                    vo_cderro,
                                    vo_dserro);

      IF vo_cderro = 2
      THEN                      -- DADOS NÃO ENCONTRADOS - ERRO NÃO IMPEDITIVO
         vo_cderro := 0;
         vo_dserro := 'Sucesso';
      END IF;
   END IF;

   IF vo_cderro = 0
   THEN
      DECLARE
         VO_SGSUBSEGMENTACAO   APOIO.SUBSEGMENTO.SGSUBSEGMENTO%TYPE;
         VO_DSSUBSEGMENTACAO   APOIO.SUBSEGMENTO.DSSUBSEGMENTO%TYPE;
      BEGIN
         --EXECUTANDO NFO_BUSCAPESSOASEGMENTACAO
         nfo_buscapessoasegmentacao (vo_idpessoadepara,
                                     vo_idsegmentacao,
                                     vo_vlrentabilidade,
                                     vo_dtsegmentacao,
                                     vo_dtrentabilidade,
                                     vo_idusuarioalteracaops,
                                     vo_dtultimaalteracaops,
                                     vo_sgsegmentacao,
                                     vo_dssegmentacao,
                                     VO_SGSUBSEGMENTACAO,
                                     VO_DSSUBSEGMENTACAO,
                                     vo_vlpesops,
                                     vo_idtipocarteirapf,
                                     vo_cderro,
                                     vo_dserro);
      END;


      IF vo_cderro = 2
      THEN                      -- DADOS NÃO ENCONTRADOS - ERRO NÃO IMPEDITIVO
         vo_cderro := 0;
         vo_dserro := 'Sucesso';
      END IF;
   END IF;

   IF vo_cderro = 0
   THEN
      BEGIN
         SELECT /*+ first_rows(1) */
          COUNT (doc.nrdocumento)
           INTO vo_possuiofertadisponivel
           FROM customer.documentoofertasgp doc
          WHERE doc.nrdocumento = vo_nrdocumento 
            AND ROWNUM <= 1;

         IF vo_possuiofertadisponivel <> 0
         THEN
            vo_possuiofertadisponivel := 1;
         END IF;
      END;
   END IF;

   -- Indica se a linha esta no programa de relacionamento
   soa_ow.prc_validarpr (NULL                                -- DDD + TELEFONE
                             ,
                         vo_nrdocumento,
                         vo_inprogrelacionamento,
                         w_cderro,
                         w_dserro);
EXCEPTION
   WHEN OTHERS
   THEN
      vo_cderro := 99;
      vo_dserro :=
         'ERRO NR.: ' || SQLCODE || ' - DESCRIÇÃO DO ERRO: ' || SQLERRM;
END nfo_buscardadosbasicospessoa;
/


